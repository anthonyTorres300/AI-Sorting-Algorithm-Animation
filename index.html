<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Animation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f0f0f0;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        .container {
            display: flex;
            align-items: flex-end;
            height: 400px;
            margin: 20px 0;
            gap: 2px;
        }
        .bar {
            background: #6b5b95;
            width: 30px;
            transition: height 0.3s ease, background-color 0.3s ease;
            border-radius: 3px 3px 0 0;
        }
        .comparing {
            background: #feb236 !important;
        }
        .swapping {
            background: #d64161 !important;
        }
        .sorted {
            background: #88b04b !important;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .controls {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Bubble Sort Animation</h1>
    <div class="controls">
        <button id="startBtn">Start Sorting</button>
        <button id="resetBtn">Reset</button>
    </div>
    <div class="container" id="visualization"></div>
    <div id="status">Click "Start Sorting" to begin</div>

    <script>
        const container = document.getElementById('visualization');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const statusEl = document.getElementById('status');
        let bars = [];
        let isSorting = false;

        // Initialize random array
        function initArray() {
            container.innerHTML = '';
            bars = [];
            for (let i = 0; i < 15; i++) {
                bars.push(Math.floor(Math.random() * 90) + 10);
            }
            renderBars();
        }

        // Render bars
        function renderBars(highlightIndices = [], sortedIndices = []) {
            container.innerHTML = '';
            const maxHeight = Math.max(...bars);
            
            bars.forEach((value, index) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${(value / maxHeight) * 350}px`;
                
                if (sortedIndices.includes(index)) {
                    bar.classList.add('sorted');
                } else if (highlightIndices.includes(index)) {
                    bar.classList.add(highlightIndices.length === 2 ? 'comparing' : 'swapping');
                }
                
                container.appendChild(bar);
            });
        }

        // Bubble Sort with animation
        async function bubbleSort() {
            if (isSorting) return;
            isSorting = true;
            startBtn.disabled = true;
            
            let len = bars.length;
            let sortedIndices = [];
            
            for (let i = 0; i < len; i++) {
                for (let j = 0; j < len - i - 1; j++) {
                    statusEl.textContent = `Comparing elements at positions ${j} and ${j+1}`;
                    
                    // Highlight comparing bars
                    renderBars([j, j+1], sortedIndices);
                    await sleep(500);
                    
                    if (bars[j] > bars[j+1]) {
                        statusEl.textContent = `Swapping ${bars[j]} and ${bars[j+1]}`;
                        
                        // Highlight swapping bars
                        renderBars([j, j+1], sortedIndices);
                        await sleep(300);
                        
                        // Swap
                        [bars[j], bars[j+1]] = [bars[j+1], bars[j]];
                        
                        // Show swap result
                        renderBars([j], sortedIndices);
                        await sleep(500);
                    }
                }
                sortedIndices.push(len - i - 1);
                renderBars([], sortedIndices);
                await sleep(200);
            }
            
            statusEl.textContent = 'Sorting complete!';
            renderBars([], Array.from({length: bars.length}, (_, i) => i));
            isSorting = false;
            startBtn.disabled = false;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Event listeners
        startBtn.addEventListener('click', bubbleSort);
        resetBtn.addEventListener('click', () => {
            if (!isSorting) {
                initArray();
                statusEl.textContent = 'Array reset. Click "Start Sorting" to begin';
            }
        });

        // Initialize
        initArray();
    </script>
</body>
</html>